<!DOCTYPE html>
<html lang="ar">
<head>
    <!-- ... (الأنماط نفسها) ... -->
    <style>
        /* أنماط إضافية لزر التنزيل */
        .download-btn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ... (نفس الهيكل السابق) ... -->

        <!-- زر تنزيل الرموز -->
        <button class="download-btn" onclick="downloadCodes()">
            تنزيل جميع الرموز ⬇️
        </button>

        <!-- ... (بقية العناصر) ... -->
    </div>

    <script>
        // توليد 30 ألف رمز فريد
        const generateRandomCode = (length = 12) => {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            return Array.from({length}, () => 
                chars[Math.floor(Math.random() * chars.length)]
            ).join('');
        };

        const allowedCodes = new Set();
        const totalCodes = 30000;

        // توليد الرموز
        while(allowedCodes.size < totalCodes) {
            allowedCodes.add(generateRandomCode());
        }

        // دالة التحقق المعدلة
        function validateForm(event) {
            event.preventDefault();
            const input = document.getElementById("numberInput").value.toUpperCase();
            const resultElement = document.getElementById("result");
            
            resultElement.className = '';
            resultElement.textContent = '';

            const usedCodes = JSON.parse(localStorage.getItem("usedCodes")) || [];

            if(usedCodes.includes(input)) {
                resultElement.textContent = "❌ تم استخدام هذا الرمز مسبقاً!";
                resultElement.className = 'error';
                return;
            }

            if(allowedCodes.has(input)) {
                usedCodes.push(input);
                localStorage.setItem("usedCodes", JSON.stringify(usedCodes));
                resultElement.textContent = "✅ الرمز صحيح!";
                resultElement.className = 'success';
            } else {
                resultElement.textContent = "❌ الرمز غير صحيح!";
                resultElement.className = 'error';
            }
        }

        // دالة تنزيل الرموز
        function downloadCodes() {
            const codes = Array.from(allowedCodes);
            const blob = new Blob([codes.join('\n')], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'verification_codes.txt';
            document.body.appendChild(a);
            a.click();
            
            URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }

        // دالة الضغط على Enter
        function handleKeyPress(event) {
            if(event.key === "Enter") validateForm(event);
        }
    </script>
</body>
</html>
